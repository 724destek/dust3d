<!DOCTYPE html>
<html>
<head>
<style>
html {
    height: 100%;
}
body {
    min-height: 100%;
    margin: auto;
}
canvas {
    width: 100%;
    height: 100%;
}
</style>
<script src="qrc:/scripts/tfjs.js"></script>
<script src="qrc:/scripts/posenet.js"></script>
</head>
<body>
<canvas id="output" />
<script>
navigator.getUserMedia = navigator.getUserMedia ||
navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

var canvas = document.getElementById("output");
var context = canvas.getContext("2d");
var net = undefined;
posenet.load(1.0).then(function(n){
    console.log("posenet loaded");
    net = n;
});

var image = new Image();
image.onload = function() 
{
    var imageScaleFactor = 0.5;
    var outputStride = 16;
    var flipHorizontal = true;
    if (undefined != net) {
        net.estimateSinglePose(image, imageScaleFactor, flipHorizontal, outputStride).then(pose => {
            console.log(JSON.stringify(pose));
        });
    }
    context.drawImage(image, 0, 0);
};

function updateImage(content) 
{
    image.src = content;
}
</script>
</body>
</html>